- name: Add Owncloud APT repository
  apt_repository: repo={{ item.repo }} state=present filename={{ item.name }}
  with_items:
      - name: owncloud
        repo: 'deb http://download.opensuse.org/repositories/isv:/ownCloud:/desktop/Ubuntu_16.10/ /'

- name: Add owncloud repo key
  apt_key: url=http://download.opensuse.org/repositories/isv:ownCloud:desktop/Ubuntu_16.10/Release.key state=present

- name: Update packages
  apt: update_cache=yes

- name: Install common GUI Packages
  apt: state=latest name={{item}}
  with_items: 
    - caffeine
    - chromium-browser
    - file-roller
    - firefox
    - flashplugin-installer
    - gimp
    - gnucash
    - gparted
    - inkscape
    - keepassx
    - lame 
    - libreoffice
    - lxappearance
    - meld
    - owncloud-client
    - picard
    - pidgin
    - speedcrunch
    - thunar
    - terminator
    - vlc

- name: Link terminator configuration
  become: no
  file: state=link src={{role_path}}/files/terminator path="{{ lookup('env','HOME') }}/.config/terminator"

#Dropbox
#TODO: Get download link dynamically
- name: Install Dropbox from official link
  apt: deb=https://linux.dropbox.com/packages/ubuntu/dropbox_2015.10.28_amd64.deb

#Franz
- name: Clear existing franz directory
  become: no
  file: path={{ lookup('env','HOME') }}/applications/franz state=absent
- name: Recreate franz directory
  become: no
  file: path={{ lookup('env','HOME') }}/applications/franz state=directory
#- name: Download and unpack
  # (use github_releases from ansible 2.2 on)
  # (use unarchive from ansible 2.2 up)
  # https://github.com/meetfranz/franz-app/releases/download/4.0.4/Franz-linux-x64-4.0.4.tgz
  #unarchive: remote_src=yes dest={{ lookup('env','HOME') }}/applications/franz src=https://github.com/meetfranz/franz-app/releases/download/4.0.4/Franz-linux-x64-4.0.4.tgz
- name: Download franz package
  uri: dest=/tmp/franz.tgz url=https://github.com/meetfranz/franz-app/releases/download/4.0.4/Franz-linux-x64-4.0.4.tgz

- name: Unpack franz
  become: no
  unarchive: copy=no dest={{ lookup('env','HOME') }}/applications/franz src=/tmp/franz.tgz
- name: Remove franz package
  file: path=/tmp/franz.tgz state=absent

- name: Link franz executable to directory in path
  become: no
  file: state=link src={{ lookup('env','HOME') }}/applications/franz/Franz path={{ lookup('env','HOME') }}/bin/franz force=yes

